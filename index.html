<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RASSTUBE ULTIMATE | v4.5 Elite Ecosystem</title>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --accent: #FF0032;
            --accent-soft: rgba(255, 0, 50, 0.15);
            --accent-glow: rgba(255, 0, 50, 0.5);
            --bg-deep: #050505;
            --bg-card: #0F0F0F;
            --bg-elevated: #1A1A1A;
            --bg-input: #121212;
            --text-main: #FFFFFF;
            --text-dim: #909090;
            --border: rgba(255, 255, 255, 0.08);
            --ai-color: #00D1FF;
            --ai-glow: rgba(0, 209, 255, 0.3);
            --success: #00FF85;
            --warning: #FFAA00;
            --youtube-red: #FF0000;
            --instagram-purple: #E4405F;
            --tiktok-pink: #FF0050;
            --radius-xl: 32px;
            --radius-lg: 20px;
            --radius-md: 12px;
            --shadow-lg: 0 20px 40px rgba(0,0,0,0.6);
            --transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        }

        /* ANIMATIONS EXISTANTES */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulseAccent { 0% { box-shadow: 0 0 0 0 var(--accent-glow); } 70% { box-shadow: 0 0 0 15px rgba(255, 0, 50, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 0, 50, 0); } }
        @keyframes pulseAI { 0% { box-shadow: 0 0 0 0 var(--ai-glow); } 70% { box-shadow: 0 0 0 10px rgba(0, 209, 255, 0); } 100% { box-shadow: 0 0 0 0 rgba(0, 209, 255, 0); } }
        @keyframes slideInRight { from { transform: translateX(100%); } to { transform: translateX(0); } }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes heartbeat { 0% { transform: scale(1); } 25% { transform: scale(1.1); } 50% { transform: scale(1); } 75% { transform: scale(1.1); } 100% { transform: scale(1); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes typing { 0% { width: 0; } 100% { width: 100%; } }
        @keyframes glow { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        @keyframes compressProgress { 0% { width: 0%; } 50% { width: 50%; } 100% { width: 100%; } }

        /* === NOUVELLES ANIMATIONS === */
        @keyframes fireBurn {
            0% { transform: scale(1); opacity: 1; filter: drop-shadow(0 0 0 rgba(255, 0, 50, 0.7)); }
            50% { transform: scale(1.15); opacity: 0.9; filter: drop-shadow(0 0 15px rgba(255, 0, 50, 0.9)); }
            100% { transform: scale(1); opacity: 1; filter: drop-shadow(0 0 0 rgba(255, 0, 50, 0.7)); }
        }
        @keyframes heartExplode {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-150px) scale(0.3); opacity: 0; rotate: 180deg; }
        }
        @keyframes levelUp {
            0% { transform: scale(0.8); filter: brightness(1); }
            50% { transform: scale(1.3); filter: brightness(1.8); }
            100% { transform: scale(1); filter: brightness(1); }
        }
        @keyframes freezeEffect {
            0% { transform: scale(1); filter: brightness(1); opacity: 0.8; }
            50% { transform: scale(1.2); filter: brightness(1.5); opacity: 1; }
            100% { transform: scale(1); filter: brightness(1); opacity: 0.8; }
        }
        @keyframes swipeHint {
            0% { transform: translateY(0); opacity: 0.8; }
            50% { transform: translateY(-10px); opacity: 1; }
            100% { transform: translateY(0); opacity: 0.8; }
        }
        @keyframes rewardShine {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.5); }
            50% { transform: scale(1.08); box-shadow: 0 0 30px 10px rgba(255, 215, 0, 0.8); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.5); }
        }
        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        /* === STYLES POUR LES NOUVELLES ANIMATIONS === */
        .heart-explosion {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            animation: heartExplode 1.2s ease-out forwards;
        }
        .heart-explosion i {
            color: #FF0032;
            font-size: 24px;
            text-shadow: 0 0 10px rgba(255, 0, 50, 0.7);
            display: block;
        }
        .flame-animation {
            animation: fireBurn 1.5s infinite alternate;
            filter: drop-shadow(0 0 8px rgba(255, 0, 50, 0.7));
        }
        .freeze-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(173, 216, 230, 0.15);
            pointer-events: none;
            z-index: 9998;
            display: none;
        }
        .freeze-icon {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 100px;
            color: #00D1FF;
            z-index: 9999;
            animation: freezeEffect 2.5s infinite;
            display: none;
            text-shadow: 0 0 20px rgba(0, 209, 255, 0.7);
        }
        .level-up-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(255, 215, 0, 0.4) 0%, transparent 70%);
            pointer-events: none;
            z-index: 9998;
            display: none;
            animation: levelUp 1.2s ease-out;
        }
        .swipe-hint {
            position: fixed;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 14px;
            z-index: 999;
            display: none;
            animation: swipeHint 2s infinite;
            border: 1px solid var(--accent);
        }
        .reward-shine {
            animation: rewardShine 2.5s infinite alternate;
        }
        .confetti-piece {
            position: fixed;
            width: 10px;
            height: 10px;
            background: linear-gradient(45deg, #FF0032, #FF8A00, #00D1FF, #00FF85);
            border-radius: 2px;
            z-index: 9999;
            pointer-events: none;
        }
    </style>
</head>
<body>

<div id="notification-box"></div>

<!-- === NOUVEAUX √âL√âMENTS D'ANIMATION === -->
<div class="freeze-overlay" id="freeze-overlay"></div>
<div class="freeze-icon" id="freeze-icon"><i class="fas fa-snowflake"></i></div>
<div class="level-up-effect" id="level-up-effect"></div>
<div class="swipe-hint" id="swipe-hint">
    <i class="fas fa-arrow-up"></i> Glissez vers le haut pour le prochain RShort
</div>

<!-- AUDIO (optionnel) -->
<audio id="like-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" preload="auto"></audio>
<audio id="levelup-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3" preload="auto"></audio>
<audio id="flame-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-fire-crackling-1626.mp3" preload="auto"></audio>
<audio id="reward-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-a-chime-2016.mp3" preload="auto"></audio>

<!-- XP Bar -->
<div class="xp-bar hidden" id="xp-bar">
    <div class="xp-progress" id="xp-progress" style="width: 30%"></div>
</div>

<!-- Streak Counter -->
<div class="streak-counter hidden" id="streak-counter">
    <i class="fas fa-fire" id="flame-icon"></i>
    <span id="streak-days">7 jours</span>
</div>

<!-- Daily Reward -->
<div class="daily-reward hidden" id="daily-reward" onclick="App.claimDailyReward()">
    <i class="fas fa-gift"></i>
    <div>
        <strong>R√âCOMPENSE QUOTIDIENNE</strong>
        <div style="font-size: 12px;">Cliquez pour r√©clamer !</div>
    </div>
</div>

<!-- AUTH PORTAL -->
<div id="auth-portal">
    <!-- ... (le reste du code HTML existant reste inchang√©) ... -->
    <!-- Je ne r√©p√®te pas le HTML existant pour √©viter la redondance -->
</div>

<!-- MAIN APP -->
<div id="main-app">
    <!-- ... (le reste du code HTML existant reste inchang√©) ... -->
</div>

<script>
/**
 * RASSTUBE ULTIMATE v4.5 - Addictive AI Chat & Social Network with Video Compressor
 * Avec animations am√©lior√©es et effets visuels/sonores
 */

const App = {
    // √âTAT GLOBAL (inchang√©)
    state: {
        users: JSON.parse(localStorage.getItem('rt_v4_users') || '[]'),
        posts: JSON.parse(localStorage.getItem('rt_v4_posts') || '[]'),
        session: JSON.parse(localStorage.getItem('rt_v4_session') || 'null'),
        currentTab: 'login',
        selectedPfp: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Rass',
        activeSection: 'home',
        currentUploadFile: null,
        compressedVideoReady: null,
        subscriptions: JSON.parse(localStorage.getItem('rt_v4_subscriptions') || '{}'),
        messages: JSON.parse(localStorage.getItem('rt_v4_messages') || '[]'),
        savedPosts: JSON.parse(localStorage.getItem('rt_v4_saved') || '[]'),
        currentRshort: 0,
        rshortPlaying: true,
        profileTab: 'posts',

        // Syst√®me addictif
        streakDays: parseInt(localStorage.getItem('rt_streak') || '1'),
        lastLogin: localStorage.getItem('rt_last_login') || '',
        xp: parseInt(localStorage.getItem('rt_xp') || '150'),
        level: parseInt(localStorage.getItem('rt_level') || '1'),
        dailyRewardClaimed: localStorage.getItem('rt_daily_reward') === new Date().toDateString(),
        flames: parseInt(localStorage.getItem('rt_flames') || '0'),
        flameFreeze: parseInt(localStorage.getItem('rt_flame_freeze') || '0'),

        // IA Chat
        aiConversation: [],
        aiPersonality: 'enthusiastic',

        // Syst√®me de compression
        compressor: {
            currentFile: null,
            quality: 'medium',
            compressedBlob: null
        },

        // R√©ponses IA programm√©es (inchang√©es)
        aiResponses: {
            growth: [
                "üéØ Pour gagner des abonn√©s rapidement : Publiez du contenu √† heure fixe chaque jour, utilisez au moins 5 hashtags pertinents, et collaborez avec d'autres cr√©ateurs de votre niche !",
                // ... (le reste des r√©ponses IA existantes)
            ],
            // ... (autres cat√©gories inchang√©es)
        }
    },

    // === FONCTIONS MODIFI√âES AVEC ANIMATIONS ===

    // 1. Fonction likePost avec animation de c≈ìurs
    likePost(id) {
        const post = this.state.posts.find(p => p.id === id);
        if(!post) return;

        const index = post.likedBy.indexOf(this.state.session.pseudo);

        if(index === -1) {
            post.likes++;
            post.likedBy.push(this.state.session.pseudo);
            this.notify("‚ù§Ô∏è Publication aim√©e ! +5 XP", "success");
            this.addXP(5);

            // === ANIMATION DE C≈íURS EXPLOSIFS ===
            for(let i = 0; i < 15; i++) {
                const heart = document.createElement('div');
                heart.className = 'heart-explosion';
                heart.innerHTML = '<i class="fas fa-heart"></i>';
                heart.style.left = `${Math.random() * 90 + 5}%`;
                heart.style.top = `${Math.random() * 70 + 15}%`;
                heart.style.animationDelay = `${i * 0.05}s`;
                heart.style.fontSize = `${Math.random() * 20 + 15}px`;
                document.body.appendChild(heart);
                setTimeout(() => heart.remove(), 1200);
            }

            // Son de like
            const likeSound = document.getElementById('like-sound');
            if (likeSound) {
                likeSound.currentTime = 0;
                likeSound.play().catch(e => console.log("Audio blocked:", e));
            }
        } else {
            post.likes--;
            post.likedBy.splice(index, 1);
            this.notify("Like retir√©", "info");
        }

        this.sync();
        this.renderRshorts();
    },

    // 2. Fonction addXP avec effet de niveau up
    addXP(amount) {
        this.state.xp += amount;
        const oldLevel = this.state.level;
        this.state.level = Math.floor(this.state.xp / 100) + 1;

        if(this.state.level > oldLevel) {
            // === EFFET VISUEL DE NIVEAU UP ===
            const levelUpEffect = document.getElementById('level-up-effect');
            levelUpEffect.style.display = 'block';

            // Confettis
            for(let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti-piece';
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.top = `${Math.random() * -100 - 50}px`;
                confetti.style.animationDelay = `${i * 0.05}s`;
                confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
                confetti.style.backgroundPosition = `${Math.random() * 100}%`;
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }

            // Son de niveau up
            const levelSound = document.getElementById('levelup-sound');
            if (levelSound) {
                levelSound.currentTime = 0;
                levelSound.play().catch(e => console.log("Audio blocked:", e));
            }

            setTimeout(() => {
                levelUpEffect.style.display = 'none';
            }, 1200);

            this.showAchievement(`Niveau ${this.state.level} atteint !`, 'fas fa-star', 'Vous progressez rapidement !');
            this.notify(`üéâ Niveau ${this.state.level} ! Nouvelle r√©compense d√©bloqu√©e`, 'success');
        }

        localStorage.setItem('rt_xp', this.state.xp.toString());
        localStorage.setItem('rt_level', this.state.level.toString());
        this.updateXPBar();
    },

    // 3. Fonction updateFlames avec animation de flammes
    updateFlames() {
        const today = new Date().toDateString();
        const user = this.state.session;

        // Si gel actif
        if (user.flameFreeze > 0) {
            user.flameFreeze--;
            this.notify(`‚ùÑÔ∏è Gel des flammes : ${user.flameFreeze} jour(s) restant(s)`, 'info');

            if (user.flameFreeze === 0) {
                document.getElementById('freeze-overlay').style.display = 'none';
                document.getElementById('freeze-icon').style.display = 'none';
            } else {
                document.getElementById('freeze-overlay').style.display = 'block';
                document.getElementById('freeze-icon').style.display = 'block';
            }

            localStorage.setItem('rt_flame_freeze', user.flameFreeze);
            return;
        }

        // Mise √† jour des flammes
        if (user.lastLogin !== today) {
            const yesterday = new Date(Date.now() - 86400000).toDateString();
            if (user.lastLogin !== yesterday) {
                this.state.flames = 0;
                this.notify(`üî• Vos flammes se sont √©teintes !`, 'warning');
                document.getElementById('flame-icon').classList.remove('flame-animation');
            } else {
                this.state.flames++;
                this.notify(`üî• +1 flamme ! (Total : ${this.state.flames})`, 'success');

                // === ANIMATION DE FLAMME ===
                const flameIcon = document.getElementById('flame-icon');
                if (flameIcon) {
                    flameIcon.classList.add('flame-animation');
                    setTimeout(() => {
                        flameIcon.classList.remove('flame-animation');
                        setTimeout(() => flameIcon.classList.add('flame-animation'), 10);
                    }, 1500);
                }

                // Son de flamme
                const flameSound = document.getElementById('flame-sound');
                if (flameSound) {
                    flameSound.currentTime = 0;
                    flameSound.volume = 0.3;
                    flameSound.play().catch(e => console.log("Audio blocked:", e));
                }
            }
            user.lastLogin = today;
        }

        document.getElementById('flame-count').innerText = this.state.flames;
        localStorage.setItem('rt_flames', this.state.flames);
        localStorage.setItem('rt_last_login', today);
    },

    // 4. Fonction freezeFlames avec effet visuel
    freezeFlames() {
        if (this.state.session.flameFreeze > 0) {
            this.notify(`‚ùÑÔ∏è Vos flammes sont d√©j√† gel√©es pour ${this.state.session.flameFreeze} jour(s)`, 'warning');
            return;
        }

        this.state.session.flameFreeze = 3;
        document.getElementById('freeze-overlay').style.display = 'block';
        document.getElementById('freeze-icon').style.display = 'block';

        // Animation de gel
        const freezeIcon = document.getElementById('freeze-icon');
        freezeIcon.style.animation = 'none';
        setTimeout(() => {
            freezeIcon.style.animation = 'freezeEffect 2.5s infinite';
        }, 10);

        this.notify(`‚ùÑÔ∏è Flammes gel√©es pour 3 jours !`, 'success');
        localStorage.setItem('rt_flame_freeze', 3);
    },

    // 5. Fonction claimDailyReward avec effet brillant
    claimDailyReward() {
        this.state.dailyRewardClaimed = true;
        localStorage.setItem('rt_daily_reward', new Date().toDateString());

        const rewardXP = 50 + (this.state.streakDays * 10);
        this.addXP(rewardXP);

        // === EFFET DE R√âCOMPENSE ===
        const rewardBtn = document.getElementById('daily-reward');
        rewardBtn.classList.add('reward-shine');

        // Son de r√©compense
        const rewardSound = document.getElementById('reward-sound');
        if (rewardSound) {
            rewardSound.currentTime = 0;
            rewardSound.play().catch(e => console.log("Audio blocked:", e));
        }

        setTimeout(() => {
            rewardBtn.classList.remove('reward-shine');
            document.getElementById('daily-reward').classList.add('hidden');
        }, 2500);

        this.showAchievement(`R√©compense quotidienne !`, 'fas fa-gift', `+${rewardXP} XP gagn√©s !`);
        this.notify(`üéÅ R√©compense quotidienne : +${rewardXP} XP ! Revenez demain`, 'success');
    },

    // 6. Fonction renderRshorts avec hint de swipe
    renderRshorts() {
        const rshorts = this.state.posts.filter(p => p.type === 'rshort');
        if(rshorts.length === 0) {
            document.getElementById('rsshort-container').innerHTML = `
                <div style="display:flex; align-items:center; justify-content:center; height:100%; background:var(--bg-deep); color:white;">
                    <div style="text-align:center;">
                        <i class="fas fa-play-circle" style="font-size:60px; color:var(--tiktok-pink); margin-bottom:20px;"></i>
                        <h3>Aucun RShort disponible</h3>
                        <p>Soyez le premier √† cr√©er un RShort !</p>
                        <button onclick="App.go('upload')" style="margin-top:20px; padding:12px 25px; background:var(--tiktok-pink); color:white; border:none; border-radius:var(--radius-md); cursor:pointer;">
                            Cr√©er mon premier RShort
                        </button>
                    </div>
                </div>
            `;
            return;
        }

        // === AFFICHER LE HINT DE SWIPE ===
        document.getElementById('swipe-hint').style.display = 'block';
        setTimeout(() => {
            document.getElementById('swipe-hint').style.display = 'none';
        }, 4000);

        const currentRshort = rshorts[this.state.currentRshort];

        // ... (le reste de la fonction renderRshorts existante reste inchang√©)
        // Container principal
        document.getElementById('rsshort-container').innerHTML = `
            <video class="rsshort-video" id="rsshort-video" autoplay muted playsinline>
                <source src="${currentRshort.content}" type="video/mp4">
            </video>
        `;

        // ... (le reste de la fonction reste inchang√©)
    },

    // === NOUVELLE FONCTION POUR G√âRER LES SONS ===
    toggleSounds() {
        const soundButtons = document.querySelectorAll('[onclick="App.toggleSounds()"]');
        const soundsEnabled = !soundButtons[0]?.classList.contains('muted');

        if (soundsEnabled) {
            // D√©sactiver les sons
            soundButtons.forEach(btn => {
                btn.innerHTML = '<i class="fas fa-volume-mute"></i> Sons OFF';
                btn.classList.add('muted');
            });
            document.querySelectorAll('audio').forEach(audio => audio.muted = true);
            this.notify("üîá Sons d√©sactiv√©s", "info");
        } else {
            // Activer les sons
            soundButtons.forEach(btn => {
                btn.innerHTML = '<i class="fas fa-volume-up"></i> Sons ON';
                btn.classList.remove('muted');
            });
            document.querySelectorAll('audio').forEach(audio => audio.muted = false);
            this.notify("üîä Sons activ√©s", "success");
        }
    },

    // === FONCTIONS EXISTANTES INCHANG√âES ===
    // (Toutes les autres fonctions restent exactement les m√™mes)
    init() { /* ... */ },
    createDefaultData() { /* ... */ },
    launch() { /* ... */ },
    updateStreak() { /* ... */ },
    updateXPBar() { /* ... */ },
    checkDailyReward() { /* ... */ },
    showAchievement() { /* ... */ },
    setCompressionQuality() { /* ... */ },
    handleCompressorFile() { /* ... */ },
    startCompression() { /* ... */ },
    simulateCompression() { /* ... */ },
    downloadCompressedVideo() { /* ... */ },
    uploadCompressedVideo() { /* ... */ },
    sendAIMessage() { /* ... */ },
    sendAIQuick() { /* ... */ },
    addAIMessage() { /* ... */ },
    generateAIResponse() { /* ... */ },
    getDailyTip() { /* ... */ },
    nextRshort() { /* ... */ },
    toggleRshortPlay() { /* ... */ },
    sharePost() { /* ... */ },
    previewUpload() { /* ... */ },
    publishPost() { /* ... */ },
    setupDragAndDrop() { /* ... */ },
    formatNumber() { /* ... */ },
    formatTime() { /* ... */ },
    notify() { /* ... */ },
    go() { /* ... */ },
    toggleAuth() { /* ... */ },
    executeAuth() { /* ... */ },
    showAuthMessage() { /* ... */ },
    verifySession() { /* ... */ },
    sync() { /* ... */ },
    updateProfileStats() { /* ... */ },
    renderStories() { /* ... */ },
    renderFeed() { /* ... */ },
    renderAvatars() { /* ... */ },
    selectPfp() { /* ... */ },
    handlePfpFile() { /* ... */ },
    triggerPfpUpload() { /* ... */ },
    editProfile() { /* ... */ },
    showNotifications() { /* ... */ },
    showMessages() { /* ... */ },
    switchProfileTab() { /* ... */ },
    renderProfilePosts() { /* ... */ },
    renderProfileRshorts() { /* ... */ },
    viewStory() { /* ... */ },
    viewPost() { /* ... */ },
    focusComment() { /* ... */ },
    filterContent() { /* ... */ }
};

// === AJOUT DU BOUTON DE CONTR√îLE DES SONS DANS LE PROFIL ===
// (√Ä ajouter dans la fonction renderProfilePosts ou renderProfileRshorts)
document.addEventListener('DOMContentLoaded', () => {
    const profileSection = document.getElementById('sec-profile');
    if (profileSection) {
        const soundButton = document.createElement('button');
        soundButton.onclick = App.toggleSounds;
        soundButton.style.cssText = `
            background: var(--bg-input);
            border: 1px solid var(--border);
            color: var(--text-main);
            padding: 8px 20px;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            margin-left: 10px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        `;
        soundButton.innerHTML = '<i class="fas fa-volume-up"></i> Sons ON';
        soundButton.classList.add('sound-toggle-btn');

        // Ins√©rer le bouton pr√®s du bouton "Modifier"
        const editButton = profileSection.querySelector('button[onclick="App.editProfile()"]');
        if (editButton) {
            editButton.parentNode.insertBefore(soundButton, editButton.nextSibling);
        }
    }
});

// GESTION DES GESTES POUR RSSHORT (inchang√©)
let startY = 0;
document.addEventListener('touchstart', (e) => {
    if(App.state.activeSection === 'rsshort') {
        startY = e.touches[0].clientY;
    }
});

document.addEventListener('touchend', (e) => {
    if(App.state.activeSection === 'rsshort') {
        const endY = e.changedTouches[0].clientY;
        const diff = startY - endY;

        if(Math.abs(diff) > 50) {
            if(diff > 0) {
                App.nextRshort(); // Glisser vers le haut
            } else {
                // Glisser vers le bas
                const rshorts = App.state.posts.filter(p => p.type === 'rshort');
                App.state.currentRshort = (App.state.currentRshort - 1 + rshorts.length) % rshorts.length;
                App.renderRshorts();
            }
        }
    }
});

// INITIALISATION
window.onload = () => {
    App.init();

    // === INITIALISATION DES √âL√âMENTS D'ANIMATION ===
    const flameIcon = document.getElementById('flame-icon');
    if (flameIcon && App.state.flames > 0) {
        flameIcon.classList.add('flame-animation');
    }

    if (App.state.session?.flameFreeze > 0) {
        document.getElementById('freeze-overlay').style.display = 'block';
        document.getElementById('freeze-icon').style.display = 'block';
    }
};
</script>
</body>
</html>