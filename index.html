<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RASSTUBE ULTIMATE | v4.0 Elite Ecosystem</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --accent: #FF0032;
            --accent-soft: rgba(255, 0, 50, 0.15);
            --accent-glow: rgba(255, 0, 50, 0.5);
            --bg-deep: #050505;
            --bg-card: #0F0F0F;
            --bg-elevated: #1A1A1A;
            --bg-input: #121212;
            --text-main: #FFFFFF;
            --text-dim: #909090;
            --border: rgba(255, 255, 255, 0.08);
            --ai-color: #00D1FF;
            --ai-glow: rgba(0, 209, 255, 0.3);
            --success: #00FF85;
            --warning: #FFAA00;
            --youtube-red: #FF0000;
            --instagram-purple: #E4405F;
            --tiktok-pink: #FF0050;
            --radius-xl: 32px;
            --radius-lg: 20px;
            --radius-md: 12px;
            --shadow-lg: 0 20px 40px rgba(0,0,0,0.6);
            --transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        }

        /* RESET & BASE */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            background-color: var(--bg-deep); color: var(--text-main); 
            margin: 0; font-family: 'Plus Jakarta Sans', sans-serif;
            overflow-x: hidden; -webkit-user-select: none;
            min-height: 100vh;
        }

        /* ANIMATIONS */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulseAccent { 0% { box-shadow: 0 0 0 0 var(--accent-glow); } 70% { box-shadow: 0 0 0 15px rgba(255, 0, 50, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 0, 50, 0); } }
        @keyframes pulseAI { 0% { box-shadow: 0 0 0 0 var(--ai-glow); } 70% { box-shadow: 0 0 0 10px rgba(0, 209, 255, 0); } 100% { box-shadow: 0 0 0 0 rgba(0, 209, 255, 0); } }
        @keyframes slideInRight { from { transform: translateX(100%); } to { transform: translateX(0); } }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes heartbeat { 0% { transform: scale(1); } 25% { transform: scale(1.1); } 50% { transform: scale(1); } 75% { transform: scale(1.1); } 100% { transform: scale(1); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes typing { 0% { width: 0; } 100% { width: 100%; } }
        @keyframes glow { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

        /* --- AUTHENTIFICATION ENGINE --- */
        #auth-portal {
            position: fixed; 
            inset: 0; 
            z-index: 9999; 
            background: radial-gradient(circle at top right, #1a0505, #000);
            display: flex; 
            align-items: flex-start;
            justify-content: center; 
            padding: 20px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .auth-container {
            width: 100%; 
            max-width: 440px; 
            background: var(--bg-card);
            border-radius: var(--radius-xl); 
            border: 1px solid var(--border);
            padding: 40px 35px; 
            box-shadow: var(--shadow-lg);
            animation: fadeIn 0.8s ease;
            margin: 20px 0;
        }

        .auth-tabs {
            display: flex; background: var(--bg-input); padding: 6px;
            border-radius: 18px; margin-bottom: 30px; border: 1px solid var(--border);
        }

        .auth-tabs button {
            flex: 1; padding: 14px; border: none; background: none;
            color: var(--text-dim); font-weight: 700; cursor: pointer;
            border-radius: 14px; transition: var(--transition);
        }

        .auth-tabs button.active { background: var(--accent); color: white; box-shadow: 0 4px 15px var(--accent-glow); }

        .input-box { margin-bottom: 20px; position: relative; }
        .input-box i { position: absolute; left: 18px; top: 18px; color: var(--text-dim); font-size: 18px; }
        .input-control {
            width: 100%; padding: 18px 18px 18px 52px; background: var(--bg-input);
            border: 1px solid var(--border); border-radius: 18px; color: white;
            font-size: 15px; transition: var(--transition);
        }
        .input-control:focus { border-color: var(--accent); outline: none; background: #161616; }

        .pfp-selector { text-align: center; margin-bottom: 25px; }
        .pfp-main-preview {
            width: 110px; height: 110px; border-radius: 50%;
            border: 3px solid var(--accent); padding: 4px; object-fit: cover;
            margin-bottom: 15px; transition: var(--transition);
        }
        .pfp-grid {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 15px;
        }
        .pfp-item {
            aspect-ratio: 1; border-radius: 14px; overflow: hidden; cursor: pointer;
            border: 2px solid transparent; transition: var(--transition);
        }
        .pfp-item.selected { border-color: var(--accent); transform: scale(1.1); }
        .pfp-item img { width: 100%; height: 100%; object-fit: cover; }

        /* --- CORE APP LAYOUT --- */
        #main-app { display: none; padding-bottom: 90px; min-height: 100vh; }

        .top-nav {
            position: sticky; top: 0; z-index: 1000;
            background: rgba(5, 5, 5, 0.95); backdrop-filter: blur(25px);
            padding: 15px 20px; border-bottom: 1px solid var(--border);
        }

        .nav-wrapper {
            max-width: 1400px; margin: 0 auto;
            display: flex; justify-content: space-between; align-items: center;
        }

        .brand { 
            font-size: 28px; font-weight: 900; 
            background: linear-gradient(45deg, #FF0032, #FF8A00);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            letter-spacing: -1.5px;
            animation: glow 2s infinite;
        }

        .search-bar {
            background: var(--bg-elevated); border-radius: 14px;
            padding: 10px 18px; display: flex; align-items: center;
            width: 40%; border: 1px solid var(--border);
            transition: var(--transition);
        }
        .search-bar:focus-within { border-color: var(--accent); box-shadow: 0 0 15px var(--accent-glow); }
        .search-bar input { background: none; border: none; color: white; margin-left: 10px; width: 100%; outline: none; }

        /* --- SECTIONS --- */
        .content-container { max-width: 1400px; margin: 0 auto; padding: 0 20px; }

        /* Stories Instagram Style */
        .story-scroller {
            display: flex; gap: 18px; overflow-x: auto; padding: 10px 0 25px;
            scrollbar-width: none;
        }
        .story-scroller::-webkit-scrollbar { display: none; }
        .story-card {
            flex-shrink: 0; width: 85px; text-align: center; cursor: pointer;
            transition: var(--transition);
        }
        .story-card:hover { transform: translateY(-5px); }
        .story-ring {
            width: 78px; height: 78px; border-radius: 50%; padding: 3px;
            background: linear-gradient(45deg, var(--instagram-purple), var(--tiktok-pink));
            margin-bottom: 8px; transition: var(--transition);
        }
        .story-card img { width: 100%; height: 100%; border-radius: 50%; border: 3px solid var(--bg-deep); object-fit: cover; }
        .story-card:active .story-ring { transform: scale(0.9); }
        .story-label { font-size: 11px; font-weight: 600; color: var(--text-dim); }

        /* --- RSSHORT SECTION (TikTok Style) --- */
        #sec-rsshort {
            position: relative;
            height: calc(100vh - 140px);
            overflow: hidden;
        }

        .rsshort-container {
            height: 100%;
            position: relative;
        }

        .rsshort-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 0;
        }

        .rsshort-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            padding: 30px 20px 100px;
            color: white;
            z-index: 2;
        }

        .rsshort-side-buttons {
            position: absolute;
            right: 20px;
            bottom: 150px;
            display: flex;
            flex-direction: column;
            gap: 25px;
            align-items: center;
            z-index: 3;
        }

        .rsshort-btn {
            background: none;
            border: none;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: var(--transition);
        }

        .rsshort-btn i {
            width: 50px;
            height: 50px;
            background: rgba(0,0,0,0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: var(--transition);
        }

        .rsshort-btn.active i {
            color: var(--accent);
            background: rgba(255, 0, 50, 0.2);
            animation: pulseAccent 2s infinite;
        }

        .rsshort-btn:active i {
            transform: scale(1.2);
        }

        .rsshort-btn:hover i {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.1);
        }

        .rsshort-progress {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255,255,255,0.3);
            z-index: 4;
        }

        .rsshort-progress-bar {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.1s linear;
        }

        /* --- IA CHAT SECTION (Addictive AI Chat) --- */
        #sec-aichat {
            position: relative;
            height: calc(100vh - 140px);
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a1a 100%);
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid rgba(0, 209, 255, 0.1);
        }

        .ai-chat-header {
            background: rgba(0, 209, 255, 0.1);
            padding: 20px;
            border-bottom: 1px solid var(--ai-glow);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .ai-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--ai-color), #0099ff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            animation: pulseAI 3s infinite;
        }

        .ai-chat-messages {
            height: calc(100% - 180px);
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .ai-message {
            max-width: 70%;
            padding: 15px;
            border-radius: 20px;
            position: relative;
            animation: fadeIn 0.3s ease;
        }

        .ai-message.user {
            background: linear-gradient(135deg, var(--accent), #ff3366);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .ai-message.bot {
            background: rgba(0, 209, 255, 0.1);
            border: 1px solid var(--ai-glow);
            margin-right: auto;
            border-bottom-left-radius: 5px;
        }

        .ai-typing {
            display: flex;
            gap: 5px;
            padding: 10px 20px;
            background: rgba(0, 209, 255, 0.05);
            border-radius: 20px;
            width: fit-content;
        }

        .ai-typing span {
            width: 8px;
            height: 8px;
            background: var(--ai-color);
            border-radius: 50%;
            animation: pulseAI 1.5s infinite;
        }

        .ai-typing span:nth-child(2) { animation-delay: 0.2s; }
        .ai-typing span:nth-child(3) { animation-delay: 0.4s; }

        .ai-quick-actions {
            display: flex;
            gap: 10px;
            padding: 15px;
            overflow-x: auto;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }

        .ai-quick-btn {
            background: rgba(0, 209, 255, 0.1);
            border: 1px solid var(--ai-glow);
            color: var(--ai-color);
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 13px;
            white-space: nowrap;
            cursor: pointer;
            transition: var(--transition);
        }

        .ai-quick-btn:hover {
            background: rgba(0, 209, 255, 0.2);
            transform: translateY(-2px);
        }

        .ai-input-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(5, 5, 5, 0.9);
            padding: 15px;
            display: flex;
            gap: 10px;
            border-top: 1px solid var(--border);
        }

        .ai-input {
            flex: 1;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 25px;
            padding: 15px 20px;
            color: white;
            font-size: 14px;
            outline: none;
            transition: var(--transition);
        }

        .ai-input:focus {
            border-color: var(--ai-color);
            box-shadow: 0 0 15px var(--ai-glow);
        }

        .ai-send-btn {
            background: linear-gradient(45deg, var(--ai-color), #0099ff);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: var(--transition);
            animation: pulseAI 3s infinite;
        }

        .ai-send-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--ai-glow);
        }

        /* --- EXPLORE SECTION --- */
        .explore-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .explore-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            overflow: hidden;
            transition: var(--transition);
            border: 1px solid var(--border);
            cursor: pointer;
        }

        .explore-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent);
        }

        .explore-thumbnail {
            width: 100%;
            aspect-ratio: 16/9;
            object-fit: cover;
            display: block;
        }

        .explore-info {
            padding: 15px;
        }

        /* --- UPLOAD SECTION --- */
        #upload-dropzone {
            transition: var(--transition);
        }

        #upload-dropzone:hover {
            border-color: var(--accent);
            background: var(--accent-soft);
            transform: translateY(-5px);
        }

        /* --- BOTTOM NAV --- */
        .bottom-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: rgba(15, 15, 15, 0.95); backdrop-filter: blur(30px);
            border-top: 1px solid var(--border); padding: 12px 10px 22px;
            display: flex; justify-content: space-around; align-items: center;
            z-index: 1000;
        }
        .nav-item { 
            color: var(--text-dim); text-align: center; 
            flex: 1; transition: var(--transition); cursor: pointer; 
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .nav-item.active { color: var(--accent); transform: translateY(-5px); }
        .nav-item.active i { animation: float 3s infinite; }
        .nav-item i { font-size: 22px; display: block; margin-bottom: 4px; transition: var(--transition); }
        .nav-item span { font-size: 10px; font-weight: 700; text-transform: uppercase; }

        .nav-item:hover {
            color: var(--accent);
            transform: translateY(-3px);
        }

        .fab-upload {
            background: var(--accent); width: 60px; height: 60px;
            border-radius: 22px; display: flex; align-items: center; justify-content: center;
            margin-top: -45px; border: 6px solid var(--bg-deep);
            color: white !important; font-size: 26px !important;
            animation: pulseAccent 2s infinite;
            cursor: pointer;
            z-index: 1001;
            transition: var(--transition);
        }

        .fab-upload:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 0 30px var(--accent-glow);
        }

        /* --- NOTIFICATION BADGES --- */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: 5px;
            background: var(--accent);
            color: white;
            font-size: 10px;
            min-width: 18px;
            height: 18px;
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: heartbeat 1s infinite;
        }

        /* --- LOADING SKELETONS --- */
        .skeleton {
            background: linear-gradient(90deg, var(--bg-input) 25%, var(--bg-elevated) 50%, var(--bg-input) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: var(--radius-md);
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            .nav-wrapper { flex-wrap: wrap; gap: 15px; }
            .search-bar { width: 100%; order: 3; }
            .content-container { padding: 0 15px; }
            .auth-container { padding: 30px 25px; margin: 10px 0; }
            #auth-portal { padding: 15px; }
            .pfp-grid { grid-template-columns: repeat(3, 1fr); }
            .bottom-bar { padding: 12px 5px 22px; }
            .nav-item i { font-size: 20px; }
            .nav-item span { font-size: 9px; }
            .explore-grid { grid-template-columns: 1fr; }
            .ai-chat-messages { height: calc(100% - 160px); }
        }

        /* --- UTILITY CLASSES --- */
        .hidden { display: none !important; }
        .visible { display: block !important; }
        .text-center { text-align: center; }
        .mt-20 { margin-top: 20px; }
        .mb-20 { margin-bottom: 20px; }

        /* --- ADDICTIVE ELEMENTS --- */
        .streak-counter {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--accent);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
            z-index: 999;
            animation: pulseAccent 2s infinite;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .xp-bar {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 6px;
            background: var(--bg-input);
            border-radius: 3px;
            overflow: hidden;
            z-index: 999;
        }

        .xp-progress {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), #ff8a00);
            transition: width 0.5s ease;
        }

        .daily-reward {
            position: fixed;
            bottom: 100px;
            right: 20px;
            background: linear-gradient(45deg, #ff8a00, #ff0032);
            color: white;
            padding: 15px;
            border-radius: var(--radius-lg);
            z-index: 999;
            animation: pulseAccent 3s infinite;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* --- ACHIEVEMENTS --- */
        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            border: 2px solid var(--accent);
            border-radius: var(--radius-lg);
            padding: 30px;
            z-index: 9999;
            animation: fadeIn 0.5s ease;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 0 50px rgba(255, 0, 50, 0.5);
        }

        .achievement-icon {
            font-size: 50px;
            color: gold;
            margin-bottom: 20px;
            animation: float 2s infinite;
        }
    </style>
</head>
<body>

<div id="notification-box"></div>

<!-- XP Bar -->
<div class="xp-bar hidden" id="xp-bar">
    <div class="xp-progress" id="xp-progress" style="width: 30%"></div>
</div>

<!-- Streak Counter -->
<div class="streak-counter hidden" id="streak-counter">
    <i class="fas fa-fire"></i>
    <span id="streak-days">7 jours</span>
</div>

<!-- Daily Reward -->
<div class="daily-reward hidden" id="daily-reward" onclick="App.claimDailyReward()">
    <i class="fas fa-gift"></i>
    <div>
        <strong>RÃ‰COMPENSE QUOTIDIENNE</strong>
        <div style="font-size: 12px;">Cliquez pour rÃ©clamer !</div>
    </div>
</div>

<div id="auth-portal">
    <div class="auth-container">
        <div class="brand text-center" style="margin-bottom: 30px; font-size: 42px;">RASSTUBE</div>
        
        <div class="auth-tabs">
            <button id="tab-login" class="active" onclick="App.toggleAuth('login')">CONNEXION</button>
            <button id="tab-signup" onclick="App.toggleAuth('signup')">INSCRIPTION</button>
        </div>

        <div id="signup-profile-setup" class="hidden">
            <div class="pfp-selector">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Rass" class="pfp-main-preview" id="auth-pfp-preview">
                <div class="mt-20">
                    <button onclick="App.triggerPfpUpload()" style="background:var(--accent-soft); color:var(--accent); border:none; padding:10px 20px; border-radius:12px; font-weight:700; cursor:pointer; display: inline-flex; align-items: center; gap: 8px;">
                        <i class="fas fa-camera"></i> MA PHOTO
                    </button>
                </div>
                <input type="file" id="real-pfp-input" class="hidden" accept="image/*" onchange="App.handlePfpFile(event)">
                
                <div class="pfp-grid" id="default-avatars"></div>
            </div>
            
            <div class="input-box">
                <i class="fas fa-user-tag"></i>
                <input type="text" id="reg-pseudo" class="input-control" placeholder="Ton Pseudo Elite">
            </div>
        </div>

        <div class="input-box">
            <i class="fas fa-envelope"></i>
            <input type="email" id="auth-email" class="input-control" placeholder="Adresse e-mail">
        </div>
        
        <div class="input-box">
            <i class="fas fa-lock"></i>
            <input type="password" id="auth-pass" class="input-control" placeholder="Mot de passe (6+ caractÃ¨res)">
        </div>

        <button onclick="App.executeAuth()" id="auth-btn" style="width: 100%; padding: 22px; background: var(--accent); color: white; border: none; border-radius: 20px; font-weight: 800; font-size: 16px; margin-top: 15px; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px;">
            <span id="auth-btn-text">REJOINDRE LE RÃ‰SEAU</span>
            <div class="loader" id="auth-loader"></div>
        </button>
        
        <p id="auth-msg" style="text-align: center; color: #ff4444; font-size: 13px; margin-top: 20px; display: none;"></p>
    </div>
</div>

<div id="main-app">
    <header class="top-nav">
        <div class="nav-wrapper">
            <div class="brand">RASSTUBE</div>
            <div class="search-bar">
                <i class="fas fa-search" style="color:var(--text-dim)"></i>
                <input type="text" id="search-input" placeholder="Rechercher vidÃ©os, photos, personnes..." onkeyup="App.filterContent(this.value)">
            </div>
            <div style="display: flex; gap: 20px; align-items: center;">
                <div style="position:relative; cursor:pointer;" onclick="App.showNotifications()">
                    <i class="fas fa-bell" style="font-size: 20px;" title="Notifications"></i>
                    <div class="notification-badge" id="notification-badge" style="display:none;">3</div>
                </div>
                <i class="fas fa-paper-plane" style="font-size: 20px; cursor: pointer;" title="Messages" onclick="App.showMessages()"></i>
                <img src="" id="user-pfp-top" style="width: 38px; height: 38px; border-radius: 50%; border: 2px solid var(--accent); cursor: pointer;" onclick="App.go('profile')" alt="Profil">
            </div>
        </div>
    </header>

    <main class="content-container">
        <!-- HOME SECTION -->
        <section id="sec-home" class="app-section">
            <div class="story-scroller" id="story-container"></div>
            <div id="main-feed"></div>
        </section>

        <!-- RSSHORT SECTION -->
        <section id="sec-rsshort" class="app-section hidden">
            <div class="reels-indicator" style="position:absolute; top:20px; left:20px; background:linear-gradient(45deg, var(--tiktok-pink), #00f2ea); color:white; padding:6px 12px; border-radius:20px; font-weight:700; font-size:12px; z-index:3;">
                <i class="fas fa-play-circle"></i> RSSHORT
            </div>
            <div class="rsshort-progress">
                <div class="rsshort-progress-bar" id="rsshort-progress"></div>
            </div>
            <div class="rsshort-container" id="rsshort-container"></div>
            <div class="rsshort-side-buttons" id="rsshort-side-buttons"></div>
            <div class="rsshort-overlay" id="rsshort-overlay"></div>
        </section>

        <!-- IA CHAT SECTION -->
        <section id="sec-aichat" class="app-section hidden">
            <div class="ai-chat-header">
                <div class="ai-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div>
                    <h3 style="margin:0; color:var(--ai-color);">Assistant IA Rasstube</h3>
                    <p style="margin:5px 0 0; color:var(--text-dim); font-size:14px;">En ligne â€¢ PrÃªt Ã  vous aider</p>
                </div>
            </div>
            
            <div class="ai-chat-messages" id="ai-chat-messages">
                <div class="ai-message bot">
                    <strong>ðŸ¤– IA Rasstube:</strong>
                    <p>Bonjour ! Je suis votre assistant IA personnel. Je peux vous aider Ã  crÃ©er du contenu, analyser vos performances, et mÃªme vous donner des conseils personnalisÃ©s !</p>
                </div>
                <div class="ai-message bot">
                    <p>Que souhaitez-vous faire aujourd'hui ? ðŸ˜Š</p>
                </div>
            </div>
            
            <div class="ai-quick-actions" id="ai-quick-actions">
                <div class="ai-quick-btn" onclick="App.sendAIQuick('Conseils pour gagner des abonnÃ©s')">ðŸ’¡ Growth Hacking</div>
                <div class="ai-quick-btn" onclick="App.sendAIQuick('IdÃ©es de contenu tendance')">ðŸš€ Contenu viral</div>
                <div class="ai-quick-btn" onclick="App.sendAIQuick('Analyser mes performances')">ðŸ“Š Analytics</div>
                <div class="ai-quick-btn" onclick="App.sendAIQuick('Optimiser mes publications')">âš¡ Optimisation</div>
                <div class="ai-quick-btn" onclick="App.sendAIQuick('Me raconter une blague')">ðŸ˜‚ Divertissement</div>
            </div>
            
            <div class="ai-input-container">
                <input type="text" class="ai-input" id="ai-input" placeholder="Posez-moi n'importe quelle question..." onkeypress="if(event.key === 'Enter') App.sendAIMessage()">
                <button class="ai-send-btn" onclick="App.sendAIMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </section>

        <!-- UPLOAD SECTION -->
        <section id="sec-upload" class="app-section hidden">
            <div style="max-width: 800px; margin: 0 auto; padding: 20px;">
                <h3 style="margin-top: 0; margin-bottom: 25px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-plus-circle" style="color:var(--accent)"></i> Nouvelle Publication
                </h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <div style="border: 2px dashed var(--border); border-radius: var(--radius-lg); padding: 40px; text-align: center; cursor: pointer;" onclick="document.getElementById('file-upload').click()" id="upload-dropzone">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 50px; color: var(--accent); margin-bottom: 15px;"></i>
                            <p style="margin: 0; font-weight: 700; font-size: 18px;">Importer un fichier</p>
                            <p style="margin: 10px 0 0; font-size: 14px; color: var(--text-dim);">VidÃ©o, photo ou RShort</p>
                            <input type="file" id="file-upload" class="hidden" accept="video/*,image/*" onchange="App.previewUpload(event)" multiple>
                        </div>

                        <div id="upload-preview" class="hidden" style="margin-top: 25px; border-radius: var(--radius-lg); overflow: hidden;"></div>
                    </div>

                    <div>
                        <div class="input-box">
                            <i class="fas fa-heading"></i>
                            <input type="text" id="up-title" class="input-control" placeholder="Titre de la publication">
                        </div>

                        <div class="input-box">
                            <i class="fas fa-tag"></i>
                            <input type="text" id="up-tags" class="input-control" placeholder="Hashtags (sÃ©parÃ©s par des virgules)">
                        </div>

                        <div class="input-box">
                            <i class="fas fa-layer-group"></i>
                            <select id="up-type" class="input-control">
                                <option value="video">ðŸŽ¬ VidÃ©o Standard</option>
                                <option value="photo">ðŸ“· Photo</option>
                                <option value="rshort">âš¡ RShort (format court)</option>
                            </select>
                        </div>

                        <button onclick="App.publishPost()" style="width: 100%; padding: 18px; background: var(--accent); color: white; border: none; border-radius: var(--radius-md); font-weight: 800; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 20px;">
                            <i class="fas fa-paper-plane"></i>
                            <span id="publish-text">PUBLIER</span>
                            <div class="loader" id="publish-loader"></div>
                        </button>
                        
                        <div style="margin-top: 20px; padding: 15px; background: var(--accent-soft); border-radius: var(--radius-md);">
                            <p style="margin: 0; font-size: 13px; color: var(--accent);">
                                <i class="fas fa-lightbulb"></i> Conseil IA : Utilisez des hashtags pertinents pour 3x plus de visibilitÃ© !
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- PROFILE SECTION -->
        <section id="sec-profile" class="app-section hidden">
            <div style="max-width: 800px; margin: 0 auto; padding: 20px;">
                <div style="display: flex; gap: 30px; margin-bottom: 40px; align-items: flex-start;">
                    <img src="" id="prof-pfp" style="width: 120px; height: 120px; border-radius: 50%; border: 4px solid var(--accent); padding: 5px; object-fit: cover;">
                    
                    <div style="flex: 1;">
                        <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 15px;">
                            <h2 id="prof-name" style="margin: 0; font-size: 28px; font-weight: 800;"></h2>
                            <button onclick="App.editProfile()" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text-main); padding: 8px 20px; border-radius: var(--radius-md); font-weight: 600; cursor: pointer;">
                                <i class="fas fa-edit"></i> Modifier
                            </button>
                        </div>
                        
                        <p id="prof-email" style="color: var(--text-dim); margin-top: 5px; margin-bottom: 20px;"></p>
                        
                        <p id="prof-bio" style="margin-bottom: 25px; line-height: 1.5;"></p>
                        
                        <div style="display: flex; gap: 30px;">
                            <div style="text-align: center;">
                                <b style="display: block; font-size: 18px;" id="count-posts">0</b>
                                <span style="font-size: 13px; color: var(--text-dim);">Publications</span>
                            </div>
                            <div style="text-align: center;">
                                <b style="display: block; font-size: 18px;" id="count-followers">0</b>
                                <span style="font-size: 13px; color: var(--text-dim);">AbonnÃ©s</span>
                            </div>
                            <div style="text-align: center;">
                                <b style="display: block; font-size: 18px;" id="count-following">0</b>
                                <span style="font-size: 13px; color: var(--text-dim);">Abonnements</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="display: flex; border-bottom: 1px solid var(--border); margin-bottom: 30px;">
                    <button class="profile-tab active" onclick="App.switchProfileTab('posts')" style="padding: 15px 20px; background: none; border: none; color: var(--accent); border-bottom: 2px solid var(--accent); font-weight: 700; cursor: pointer;">
                        <i class="fas fa-th-large"></i> Publications
                    </button>
                    <button class="profile-tab" onclick="App.switchProfileTab('rshorts')" style="padding: 15px 20px; background: none; border: none; color: var(--text-dim); font-weight: 600; cursor: pointer;">
                        <i class="fas fa-play-circle"></i> RShorts
                    </button>
                </div>

                <div id="profile-posts" class="profile-content">
                    <div class="photos-grid" id="profile-grid"></div>
                </div>
            </div>
        </section>
    </main>

    <!-- BOTTOM NAVIGATION -->
    <nav class="bottom-bar">
        <div class="nav-item active" onclick="App.go('home')">
            <i class="fas fa-home"></i>
            <span>Accueil</span>
        </div>
        <div class="nav-item" onclick="App.go('rsshort')">
            <i class="fas fa-play-circle"></i>
            <span>RShort</span>
        </div>
        <div class="fab-upload" onclick="App.go('upload')" id="fab-upload-btn">
            <i class="fas fa-plus"></i>
        </div>
        <div class="nav-item" onclick="App.go('aichat')">
            <i class="fas fa-robot"></i>
            <span>IA</span>
        </div>
        <div class="nav-item" onclick="App.go('profile')">
            <i class="fas fa-user"></i>
            <span>Profil</span>
        </div>
    </nav>
</div>

<script>
/**
 * RASSTUBE ULTIMATE v4.0 - Addictive AI Chat & Social Network
 */

const App = {
    // Ã‰TAT GLOBAL
    state: {
        users: JSON.parse(localStorage.getItem('rt_v4_users') || '[]'),
        posts: JSON.parse(localStorage.getItem('rt_v4_posts') || '[]'),
        session: JSON.parse(localStorage.getItem('rt_v4_session') || 'null'),
        currentTab: 'login',
        selectedPfp: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Rass',
        activeSection: 'home',
        isUploading: false,
        subscriptions: JSON.parse(localStorage.getItem('rt_v4_subscriptions') || '{}'),
        messages: JSON.parse(localStorage.getItem('rt_v4_messages') || '[]'),
        savedPosts: JSON.parse(localStorage.getItem('rt_v4_saved') || '[]'),
        currentRshort: 0,
        rshortPlaying: true,
        profileTab: 'posts',
        
        // SystÃ¨me addictif
        streakDays: parseInt(localStorage.getItem('rt_streak') || '1'),
        lastLogin: localStorage.getItem('rt_last_login') || '',
        xp: parseInt(localStorage.getItem('rt_xp') || '150'),
        level: parseInt(localStorage.getItem('rt_level') || '1'),
        dailyRewardClaimed: localStorage.getItem('rt_daily_reward') === new Date().toDateString(),
        
        // IA Chat
        aiConversation: [],
        aiPersonality: 'enthusiastic',
        
        // RÃ©ponses IA programmÃ©es
        aiResponses: {
            growth: [
                "ðŸŽ¯ Pour gagner des abonnÃ©s rapidement : Publiez du contenu Ã  heure fixe chaque jour, utilisez au moins 5 hashtags pertinents, et collaborez avec d'autres crÃ©ateurs de votre niche !",
                "ðŸš€ Astuce growth : Les 3 premiÃ¨res secondes de votre vidÃ©o sont cruciales. Commencez par quelque chose de choquant, drÃ´le ou intriguant pour retenir l'attention !",
                "ðŸ’¡ Conseil IA : Analysez vos heures de pointe d'engagement (gÃ©nÃ©ralement 18h-21h) et programmez vos publications en consÃ©quence pour maximiser la visibilitÃ© !",
                "ðŸ“ˆ Pour augmenter l'engagement : Posez des questions dans vos lÃ©gendes, rÃ©pondez Ã  tous les commentaires dans l'heure, et organisez des Q&A en direct !"
            ],
            content: [
                "âœ¨ IdÃ©es de contenu viral : 1) Tutoriels rapides (60s max) 2) Avant/AprÃ¨s 3) DÃ©fis tendance 4) RÃ©actions express 5) Contenu Ã©ducatif animÃ© !",
                "ðŸŽ¬ Format gagnant : Les RShorts de moins de 30 secondes avec musique tendance ont 3x plus de chances de devenir viraux !",
                "ðŸ“± Conseil crÃ©ation : Utilisez des transitions fluides, des sous-titres dynamiques et des effets sonores pour rendre votre contenu plus professionnel !",
                "ðŸ”¥ Tendances du moment : #CapCutChallenge, #AIArt, #SatisfyingVideos, #LearnIn60Seconds - Sautez sur ces trends rapidement !"
            ],
            analytics: [
                "ðŸ“Š Votre contenu performe mieux les week-ends entre 11h et 14h. Le taux d'engagement est 40% plus Ã©levÃ© Ã  ces moments !",
                "ðŸ“ˆ Votre vidÃ©o la plus vue a gardÃ© 75% des viewers jusqu'Ã  la fin. RÃ©pliquez ce format !",
                "ðŸŽ¯ Votre audience est principalement composÃ©e de 18-24 ans (65%). Adaptez votre contenu Ã  cette dÃ©mographie !",
                "ðŸ“‰ Conseil : Les vidÃ©os entre 60 et 90 secondes ont le meilleur taux de rÃ©tention sur votre profil."
            ],
            optimization: [
                "âš¡ Optimisez vos hashtags : Utilisez 3 hashtags populaires (1M+), 3 hashtags moyens (100k-1M) et 3 hashtags de niche (<100k) !",
                "ðŸŽ¨ AmÃ©liorez vos miniatures : Utilisez des couleurs vives, des visages expressifs et du texte en gros caractÃ¨res !",
                "ðŸ” SEO pour Rasstube : Incluez vos mots-clÃ©s principaux dans les 50 premiers caractÃ¨res de votre description !",
                "ðŸ’Ž Pro-tip : Utilisez des appels Ã  l'action clairs (Likez si..., Abonnez-vous pour...) pour booster vos interactions !"
            ],
            entertainment: [
                "ðŸ˜‚ Pourquoi les dÃ©veloppeurs dÃ©testent-ils la nature ? Parce qu'il y a trop de bugs ! ðŸ›",
                "ðŸŽ® Savais-tu que le premier tweet a Ã©tÃ© envoyÃ© en 2006 ? Moi non plus, je suis une IA de 2024 ! ðŸ˜„",
                "âœ¨ Blague IA : Combien de programmeurs faut-il pour changer une ampoule ? Aucun, c'est un problÃ¨me matÃ©riel ! ðŸ’¡",
                "ðŸ˜† Pourquoi le livre de mathÃ©matiques Ã©tait-il triste ? Parce qu'il avait trop de problÃ¨mes !"
            ],
            general: [
                "ðŸŒŸ Salut ! Je suis ravi de discuter avec vous aujourd'hui. Comment puis-je vous aider Ã  dominer Rasstube ?",
                "ðŸ¤– En tant qu'IA Rasstube, j'ai analysÃ© des milliers de contenus viraux. Laissez-moi vous guider vers le succÃ¨s !",
                "ðŸ’« Wow, excellente question ! Permettez-moi de vous donner les insights les plus rÃ©cents du marchÃ©...",
                "ðŸš€ PrÃªt Ã  passer au niveau supÃ©rieur ? Je dÃ©tecte un grand potentiel dans votre profil. Continuons !"
            ]
        }
    },

    // INITIALISATION
    init() {
        this.verifySession();
        this.renderAvatars();
        this.sync();

        if(this.state.session) {
            this.launch();
        }
        
        // CrÃ©er des donnÃ©es par dÃ©faut
        if(this.state.posts.length === 0) {
            this.createDefaultData();
        }
        
        // VÃ©rifier la rÃ©compense quotidienne
        this.checkDailyReward();
    },

    // CRÃ‰ATION DES DONNÃ‰ES PAR DÃ‰FAUT
    createDefaultData() {
        const defaultUsers = [
            { 
                pseudo: 'Rayan', 
                email: 'rayan@example.com',
                pass: '123456',
                pfp: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Rayan',
                bio: 'Gamer & Content Creator ðŸŽ® â€¢ 1M+ sur Rasstube',
                followers: 1245,
                following: 89
            },
            { 
                pseudo: 'Sarah', 
                email: 'sarah@example.com',
                pass: '123456',
                pfp: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Sarah',
                bio: 'Photographe voyage ðŸŒ â€¢ AventuriÃ¨re digitale',
                followers: 892,
                following: 156
            },
            { 
                pseudo: 'Alex', 
                email: 'alex@example.com',
                pass: '123456',
                pfp: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Alex',
                bio: 'Chef cuisinier ðŸ‘¨â€ðŸ³ â€¢ Recettes en 60s',
                followers: 2103,
                following: 234
            }
        ];
        
        defaultUsers.forEach(user => {
            if(!this.state.users.find(u => u.pseudo === user.pseudo)) {
                this.state.users.push({
                    id: Date.now() + Math.random(),
                    ...user,
                    joined: new Date().toLocaleDateString('fr-FR')
                });
            }
        });

        const defaultPosts = [
            {
                id: 1,
                author: 'Rayan',
                authorPfp: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Rayan',
                title: 'Nouveau record sur Fortnite ! ðŸŽ® #gaming #fortnite #record',
                type: 'rshort',
                content: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4',
                likes: 1245,
                likedBy: ['Rayan', 'Sarah'],
                comments: 89,
                shares: 45,
                views: 12500,
                duration: 15,
                timestamp: new Date(Date.now() - 3600000).toISOString(),
                tags: ['gaming', 'fortnite', 'record']
            },
            {
                id: 2,
                author: 'Sarah',
                authorPfp: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Sarah',
                title: 'Coucher de soleil Ã  Bali ðŸŒ… #voyage #bali #photographie #paradis',
                type: 'photo',
                content: 'https://images.unsplash.com/photo-1518548419970-58e3b4079ab2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                likes: 892,
                likedBy: ['Sarah', 'Alex'],
                comments: 67,
                shares: 23,
                views: 8900,
                timestamp: new Date(Date.now() - 7200000).toISOString(),
                tags: ['voyage', 'bali', 'photographie']
            }
        ];
        
        this.state.posts = defaultPosts;
        this.sync();
    },

    // LANCEMENT APP
    launch() {
        document.getElementById('auth-portal').classList.add('hidden');
        document.getElementById('main-app').style.display = 'block';
        
        // Mettre Ã  jour l'interface
        document.getElementById('user-pfp-top').src = this.state.session.pfp;
        document.getElementById('prof-pfp').src = this.state.session.pfp;
        document.getElementById('prof-name').innerText = this.state.session.pseudo;
        document.getElementById('prof-email').innerText = this.state.session.email;
        document.getElementById('prof-bio').innerText = this.state.session.bio || "Aucune bio pour le moment";
        
        // Mettre Ã  jour les streaks et XP
        this.updateStreak();
        this.updateXPBar();
        
        // Afficher les Ã©lÃ©ments addictifs
        document.getElementById('xp-bar').classList.remove('hidden');
        document.getElementById('streak-counter').classList.remove('hidden');
        if(!this.state.dailyRewardClaimed) {
            document.getElementById('daily-reward').classList.remove('hidden');
        }
        
        // Afficher la badge de notification
        document.getElementById('notification-badge').style.display = 'block';
        
        this.updateProfileStats();
        this.renderFeed();
        this.renderStories();
        this.go('home');
        
        // DÃ©clencher une notification de bienvenue
        setTimeout(() => {
            this.notify(`ðŸ”¥ Streak de ${this.state.streakDays} jours ! Continuez comme Ã§a !`, 'success');
            this.showAchievement('Bienvenue !', 'fas fa-trophy', 'Vous avez ouvert Rasstube aujourd\'hui !');
        }, 1000);
    },

    // SYSTÃˆME ADDICTIF
    updateStreak() {
        const today = new Date().toDateString();
        const yesterday = new Date(Date.now() - 86400000).toDateString();
        
        if(this.state.lastLogin === today) {
            // DÃ©jÃ  connectÃ© aujourd'hui
            return;
        } else if(this.state.lastLogin === yesterday) {
            // Streak continu
            this.state.streakDays++;
            this.showAchievement('Streak de ' + this.state.streakDays + ' jours !', 'fas fa-fire', 'Vous vous connectez chaque jour !');
        } else {
            // Streak brisÃ©
            this.state.streakDays = 1;
        }
        
        this.state.lastLogin = today;
        document.getElementById('streak-days').innerText = this.state.streakDays + ' jours';
        localStorage.setItem('rt_streak', this.state.streakDays.toString());
        localStorage.setItem('rt_last_login', today);
    },

    updateXPBar() {
        const xpNeededForNextLevel = this.state.level * 100;
        const progress = (this.state.xp % 100) / 100 * 100;
        document.getElementById('xp-progress').style.width = progress + '%';
    },

    addXP(amount) {
        this.state.xp += amount;
        const oldLevel = this.state.level;
        this.state.level = Math.floor(this.state.xp / 100) + 1;
        
        if(this.state.level > oldLevel) {
            this.showAchievement('Niveau ' + this.state.level + ' atteint !', 'fas fa-star', 'Vous progressez rapidement !');
            this.notify(`ðŸŽ‰ FÃ©licitations ! Vous avez atteint le niveau ${this.state.level} !`, 'success');
        }
        
        localStorage.setItem('rt_xp', this.state.xp.toString());
        localStorage.setItem('rt_level', this.state.level.toString());
        this.updateXPBar();
    },

    checkDailyReward() {
        const today = new Date().toDateString();
        if(localStorage.getItem('rt_daily_reward') !== today) {
            this.state.dailyRewardClaimed = false;
        }
    },

    claimDailyReward() {
        this.state.dailyRewardClaimed = true;
        localStorage.setItem('rt_daily_reward', new Date().toDateString());
        
        const rewardXP = 50 + (this.state.streakDays * 10);
        this.addXP(rewardXP);
        
        document.getElementById('daily-reward').classList.add('hidden');
        this.showAchievement('RÃ©compense quotidienne !', 'fas fa-gift', `+${rewardXP} XP gagnÃ©s !`);
        this.notify(`ðŸŽ RÃ©compense quotidienne : +${rewardXP} XP ! Revenez demain !`, 'success');
    },

    showAchievement(title, icon, description) {
        const popup = document.createElement('div');
        popup.className = 'achievement-popup';
        popup.innerHTML = `
            <div class="achievement-icon">
                <i class="${icon}"></i>
            </div>
            <h3 style="margin:0 0 10px 0; color:var(--accent);">${title}</h3>
            <p style="margin:0; color:var(--text-dim);">${description}</p>
            <button onclick="this.parentElement.remove()" style="margin-top:20px; padding:10px 20px; background:var(--accent); color:white; border:none; border-radius:var(--radius-md); cursor:pointer;">
                Super !
            </button>
        `;
        
        document.body.appendChild(popup);
        
        setTimeout(() => {
            if(popup.parentElement) {
                popup.remove();
            }
        }, 5000);
    },

    // IA CHAT ADDICTIVE
    sendAIMessage() {
        const input = document.getElementById('ai-input');
        const message = input.value.trim();
        
        if(!message) return;
        
        // Ajouter le message utilisateur
        this.addAIMessage(message, 'user');
        input.value = '';
        
        // RÃ©ponse IA avec dÃ©lai
        setTimeout(() => {
            this.generateAIResponse(message);
        }, 1000 + Math.random() * 1000);
    },

    sendAIQuick(message) {
        document.getElementById('ai-input').value = message;
        this.sendAIMessage();
    },

    addAIMessage(text, sender) {
        const container = document.getElementById('ai-chat-messages');
        const messageDiv = document.createElement('div');
        messageDiv.className = `ai-message ${sender}`;
        
        if(sender === 'user') {
            messageDiv.innerHTML = `<strong>ðŸ‘¤ Vous:</strong><p>${text}</p>`;
        } else {
            messageDiv.innerHTML = `<strong>ðŸ¤– IA Rasstube:</strong><p>${text}</p>`;
        }
        
        container.appendChild(messageDiv);
        container.scrollTop = container.scrollHeight;
        
        // Ajouter XP pour interaction
        if(sender === 'user') {
            this.addXP(5);
        }
    },

    generateAIResponse(userMessage) {
        const lowerMessage = userMessage.toLowerCase();
        let response = '';
        
        // Montrer l'indicateur de frappe
        const typingIndicator = document.createElement('div');
        typingIndicator.className = 'ai-typing';
        typingIndicator.innerHTML = '<span></span><span></span><span></span>';
        document.getElementById('ai-chat-messages').appendChild(typingIndicator);
        
        // GÃ©nÃ©rer une rÃ©ponse basÃ©e sur le message
        setTimeout(() => {
            typingIndicator.remove();
            
            if(lowerMessage.includes('abonnÃ©') || lowerMessage.includes('follower') || lowerMessage.includes('croissance')) {
                response = this.state.aiResponses.growth[Math.floor(Math.random() * this.state.aiResponses.growth.length)];
            } else if(lowerMessage.includes('contenu') || lowerMessage.includes('idÃ©e') || lowerMessage.includes('vidÃ©o')) {
                response = this.state.aiResponses.content[Math.floor(Math.random() * this.state.aiResponses.content.length)];
            } else if(lowerMessage.includes('analyse') || lowerMessage.includes('stat') || lowerMessage.includes('performance')) {
                response = this.state.aiResponses.analytics[Math.floor(Math.random() * this.state.aiResponses.analytics.length)];
            } else if(lowerMessage.includes('optim') || lowerMessage.includes('hashtag') || lowerMessage.includes('seo')) {
                response = this.state.aiResponses.optimization[Math.floor(Math.random() * this.state.aiResponses.optimization.length)];
            } else if(lowerMessage.includes('blague') || lowerMessage.includes('drÃ´le') || lowerMessage.includes('rire')) {
                response = this.state.aiResponses.entertainment[Math.floor(Math.random() * this.state.aiResponses.entertainment.length)];
            } else {
                response = this.state.aiResponses.general[Math.floor(Math.random() * this.state.aiResponses.general.length)];
            }
            
            // Ajouter des Ã©lÃ©ments addictifs
            if(Math.random() > 0.7) {
                response += `\n\nðŸŽ® **Astuce du jour** : ${this.getDailyTip()}`;
            }
            
            if(Math.random() > 0.8) {
                response += `\n\nðŸ”¥ **Votre streak** : ${this.state.streakDays} jours - Continuez comme Ã§a !`;
            }
            
            this.addAIMessage(response, 'bot');
            
            // Ajouter XP pour rÃ©ponse IA
            this.addXP(10);
        }, 1500 + Math.random() * 2000);
    },

    getDailyTip() {
        const tips = [
            "Likez 10 posts par jour pour augmenter votre visibilitÃ© de 30%",
            "Postez un RShort entre 18h et 20h pour maximiser les vues",
            "Utilisez 3 hashtags exacts dans vos 3 premiers commentaires",
            "RÃ©pondez aux commentaires dans les 15 minutes pour booster l'algorithme",
            "Collaborez avec un crÃ©ateur de votre niche cette semaine"
        ];
        return tips[Math.floor(Math.random() * tips.length)];
    },

    // RSSHORT ADDICTIVE
    renderRshorts() {
        const rshorts = this.state.posts.filter(p => p.type === 'rshort');
        if(rshorts.length === 0) {
            document.getElementById('rsshort-container').innerHTML = `
                <div style="display:flex; align-items:center; justify-content:center; height:100%; background:var(--bg-deep); color:white;">
                    <div style="text-align:center;">
                        <i class="fas fa-play-circle" style="font-size:60px; color:var(--tiktok-pink); margin-bottom:20px;"></i>
                        <h3>Aucun RShort disponible</h3>
                        <p>Soyez le premier Ã  crÃ©er un RShort !</p>
                        <button onclick="App.go('upload')" style="margin-top:20px; padding:12px 25px; background:var(--tiktok-pink); color:white; border:none; border-radius:var(--radius-md); cursor:pointer;">
                            CrÃ©er mon premier RShort
                        </button>
                    </div>
                </div>
            `;
            return;
        }
        
        const currentRshort = rshorts[this.state.currentRshort];
        
        // Container principal
        document.getElementById('rsshort-container').innerHTML = `
            <video class="rsshort-video" id="rsshort-video" autoplay muted playsinline>
                <source src="${currentRshort.content}" type="video/mp4">
            </video>
        `;
        
        // Overlay avec infos
        document.getElementById('rsshort-overlay').innerHTML = `
            <div style="margin-bottom:15px;">
                <h3 style="margin:0 0 10px 0; display:flex; align-items:center; gap:10px;">
                    <img src="${currentRshort.authorPfp}" style="width:40px; height:40px; border-radius:50%; border:2px solid var(--accent);">
                    ${currentRshort.author}
                </h3>
                <p style="margin:0; font-size:16px;">${currentRshort.title}</p>
            </div>
            <div style="display:flex; gap:15px; font-size:13px; color:var(--text-dim);">
                <span><i class="fas fa-music"></i> Son original</span>
                <span><i class="fas fa-eye"></i> ${this.formatNumber(currentRshort.views)} vues</span>
                <span><i class="fas fa-clock"></i> ${this.formatTime(currentRshort.timestamp)}</span>
            </div>
        `;
        
        // Boutons latÃ©raux avec animations
        document.getElementById('rsshort-side-buttons').innerHTML = `
            <div class="rsshort-btn ${currentRshort.likedBy.includes(this.state.session.pseudo) ? 'active' : ''}" onclick="App.likePost(${currentRshort.id})">
                <i class="fas fa-heart"></i>
                <span>${this.formatNumber(currentRshort.likes)}</span>
            </div>
            <div class="rsshort-btn" onclick="App.focusComment(${currentRshort.id})">
                <i class="fas fa-comment"></i>
                <span>${this.formatNumber(currentRshort.comments)}</span>
            </div>
            <div class="rsshort-btn" onclick="App.sharePost(${currentRshort.id})">
                <i class="fas fa-share"></i>
                <span>${this.formatNumber(currentRshort.shares)}</span>
            </div>
            <div class="rsshort-btn" onclick="App.toggleRshortPlay()">
                <i class="fas fa-${this.state.rshortPlaying ? 'pause' : 'play'}"></i>
                <span>${this.state.rshortPlaying ? 'Pause' : 'Play'}</span>
            </div>
            <div class="rsshort-btn" onclick="App.nextRshort()">
                <i class="fas fa-forward"></i>
                <span>Suivant</span>
            </div>
        `;
        
        // Configurer la vidÃ©o
        const video = document.getElementById('rsshort-video');
        if(video) {
            video.onended = () => {
                this.nextRshort();
                this.addXP(3); // XP pour avoir regardÃ© jusqu'au bout
            };
            video.onclick = () => this.toggleRshortPlay();
            
            if(this.state.rshortPlaying) {
                video.play();
            } else {
                video.pause();
            }
            
            // Barre de progression
            video.ontimeupdate = () => {
                const progress = (video.currentTime / video.duration) * 100;
                document.getElementById('rsshort-progress').style.width = progress + '%';
            };
        }
        
        // Ajouter une vue
        setTimeout(() => {
            currentRshort.views = (currentRshort.views || 0) + 1;
            this.sync();
        }, 3000);
    },

    // AUTRES FONCTIONS ESSENTIELLES (abrÃ©gÃ©es pour la lisibilitÃ©)
    // [Les fonctions existantes comme likePost, sharePost, etc. seraient ici]
    likePost(id) {
        const post = this.state.posts.find(p => p.id === id);
        if(!post) return;
        
        const index = post.likedBy.indexOf(this.state.session.pseudo);
        
        if(index === -1) {
            post.likes++;
            post.likedBy.push(this.state.session.pseudo);
            this.notify("â¤ï¸ Publication aimÃ©e ! +5 XP", "success");
            this.addXP(5);
            
            // Animation spÃ©ciale
            const heart = document.createElement('div');
            heart.innerHTML = '<i class="fas fa-heart" style="color:var(--accent); font-size:50px;"></i>';
            heart.style.cssText = 'position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); z-index:1000; animation:heartbeat 0.5s ease;';
            document.getElementById('rsshort-container').appendChild(heart);
            setTimeout(() => heart.remove(), 500);
        } else {
            post.likes--;
            post.likedBy.splice(index, 1);
            this.notify("Like retirÃ©", "info");
        }
        
        this.sync();
        this.renderRshorts();
    },

    sharePost(id) {
        const post = this.state.posts.find(p => p.id === id);
        if(!post) return;
        
        post.shares = (post.shares || 0) + 1;
        this.sync();
        this.addXP(10);
        
        this.notify("ðŸ“¤ Partage rÃ©ussi ! +10 XP", "success");
        
        if(navigator.share) {
            navigator.share({
                title: `${post.author} sur Rasstube`,
                text: post.title,
                url: window.location.href
            });
        } else {
            navigator.clipboard.writeText(`Regarde ce RShort sur Rasstube !\n\n${post.author}: ${post.title}`);
        }
        
        this.renderRshorts();
    },

    // FONCTIONS UTILITAIRES
    formatNumber(num) {
        if(num >= 1000000) return (num/1000000).toFixed(1) + 'M';
        if(num >= 1000) return (num/1000).toFixed(1) + 'k';
        return num;
    },

    formatTime(timestamp) {
        const now = new Date();
        const postDate = new Date(timestamp);
        const diff = now - postDate;
        const hours = Math.floor(diff / 3600000);
        
        if(hours < 1) return "Ã€ l'instant";
        if(hours < 24) return `Il y a ${hours}h`;
        return `${Math.floor(hours/24)}j`;
    },

    notify(msg, type = "success") {
        const box = document.getElementById('notification-box');
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        
        toast.innerHTML = `
            <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
            <div>
                <p style="margin:0; font-size:14px;">${msg}</p>
            </div>
        `;
        
        box.appendChild(toast);
        
        setTimeout(() => {
            toast.style.animation = 'slideInRight 0.5s ease reverse';
            setTimeout(() => toast.remove(), 500);
        }, 3000);
    },

    // FONCTIONS DE NAVIGATION
    go(sec) {
        document.querySelectorAll('.app-section').forEach(s => s.classList.add('hidden'));
        document.getElementById('sec-' + sec).classList.remove('hidden');
        
        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
        });
        
        const navIndexes = { home: 0, rsshort: 1, aichat: 3, profile: 4 };
        if(navIndexes[sec] !== undefined) {
            document.querySelectorAll('.nav-item')[navIndexes[sec]].classList.add('active');
        }
        
        document.getElementById('fab-upload-btn').classList.toggle('active', sec === 'upload');
        
        if(sec === 'rsshort') {
            this.renderRshorts();
        } else if(sec === 'aichat') {
            this.addXP(2); // XP pour avoir visitÃ© le chat IA
        }
        
        this.state.activeSection = sec;
    },

    // FONCTIONS D'AUTHENTIFICATION (simplifiÃ©es)
    toggleAuth(tab) {
        this.state.currentTab = tab;
        // [ImplÃ©mentation existante]
    },

    executeAuth() {
        // [ImplÃ©mentation existante simplifiÃ©e]
        setTimeout(() => {
            this.launch();
        }, 1000);
    },

    // INITIALISATION RESTANTE
    verifySession() { /* ... */ },
    sync() { /* ... */ },
    updateProfileStats() { /* ... */ },
    renderStories() { /* ... */ },
    renderFeed() { /* ... */ },
    renderAvatars() { /* ... */ },
    selectPfp(url) { /* ... */ },
    handlePfpFile(e) { /* ... */ },
    triggerPfpUpload() { /* ... */ },
    editProfile() { /* ... */ },
    showNotifications() { 
        this.notify("ðŸŽ‰ 3 nouvelles notifications !", "info");
        this.addXP(2);
    },
    showMessages() { 
        this.notify("ðŸ’¬ Messages bientÃ´t disponibles !", "info");
    }
};

// GESTION DES GESTES POUR RSSHORT
let startY = 0;
document.addEventListener('touchstart', (e) => {
    if(App.state.activeSection === 'rsshort') {
        startY = e.touches[0].clientY;
    }
});

document.addEventListener('touchend', (e) => {
    if(App.state.activeSection === 'rsshort') {
        const endY = e.changedTouches[0].clientY;
        const diff = startY - endY;
        
        if(Math.abs(diff) > 50) {
            if(diff > 0) {
                App.nextRshort(); // Glisser vers le haut
            } else {
                // Glisser vers le bas - revenir au prÃ©cÃ©dent
                const rshorts = App.state.posts.filter(p => p.type === 'rshort');
                App.state.currentRshort = (App.state.currentRshort - 1 + rshorts.length) % rshorts.length;
                App.renderRshorts();
            }
        }
    }
});

// INITIALISATION
window.onload = () => App.init();
</script>
</body>
</html>